# Configuration Production - Exemple
# Copiez ce fichier vers terraform.tfvars et adaptez les valeurs
# ‚ö†Ô∏è  ATTENTION: Configuration critique pour la production

# Configuration globale - √Ä MODIFIER
project_id   = "votre-project-id-prod"        # Remplacez par votre project ID
environment  = "prod"
region       = "europe-west1"

# Configuration r√©seau
vpc_cidr_range               = "10.2.0.0/16"
private_subnet_cidr         = "10.2.1.0/24"
public_subnet_cidr          = "10.2.2.0/24"
pods_cidr_range             = "10.2.16.0/20"
services_cidr_range         = "10.2.32.0/20"
authorized_networks         = []                # Pas d'acc√®s direct en prod

# Configuration Cloud SQL - Production (haute performance)
database_tier                = "db-custom-4-8192"  # 4 vCPU, 8 GB RAM
disk_size                   = 100                   # 100 GB
max_disk_size              = 500                   # Limite auto-resize
high_availability          = true                  # HA obligatoire
backup_retention_days      = 30                    # 30 jours
backup_location           = "europe-west4"         # Backup cross-r√©gion
point_in_time_recovery    = true                   # PITR obligatoire
maintenance_window_day    = 7                      # Dimanche
maintenance_window_hour   = 2                      # 02:00 UTC
read_replica_count        = 2                      # 2 r√©plicas
replica_tier              = "db-custom-4-8192"     # M√™me tier que principal

# Configuration Cloud Run - Production
cloud_run_cpu_limit         = "2000m"              # 2 vCPU
cloud_run_memory_limit      = "2Gi"                # 2 GB RAM
cloud_run_min_instances     = 2                    # Minimum 2 instances
cloud_run_max_instances     = 100                  # Maximum 100 instances
cloud_run_concurrency       = 100                  # 100 requ√™tes simultan√©es
cloud_run_timeout_seconds   = 300                  # Timeout 5 minutes
cloud_run_cpu_throttling    = false                # Pas de throttling

# Configuration Artifact Registry
registry_format             = "DOCKER"
registry_description        = "Production Docker registry pour centralisation de donn√©es"

# Configuration monitoring et alertes - √Ä MODIFIER OBLIGATOIREMENT
enable_monitoring           = true
alert_email                = "ops-team@votre-entreprise.com"      # Email √©quipe OPS
slack_webhook_url          = "https://hooks.slack.com/services/PROD/WEBHOOK"  # Slack PROD
sms_number                 = "+33123456789"                       # SMS pour alertes critiques

# Monitoring
notification_emails         = ["prod-alerts@example.com", "oncall@example.com"]
latency_threshold_ms       = 1000                  # 1 seconde
error_rate_threshold       = 2                     # 2%
cpu_threshold             = 0.7                    # 70%
memory_threshold          = 0.7                    # 70%
sql_connections_threshold = 200                    # 200 connexions

# Budget
budget_amount             = 500                    # 500‚Ç¨/mois
budget_alert_thresholds    = [0.5, 0.8, 0.9, 1.0]  # Alertes progressives

# S√©curit√© RENFORC√âE
enable_private_ip          = true
enable_ssl_redirect        = true
enable_armor               = true                 # Cloud Armor OBLIGATOIRE
allowed_source_ranges      = ["0.0.0.0/0"]       # Restriction via Cloud Armor
enable_audit_logs          = true                # Audit logs OBLIGATOIRES
log_retention_days         = 90                  # R√©tention 90 jours

# Configuration sp√©cifique production - CRITIQUE
deletion_protection        = true                # Protection OBLIGATOIRE
skip_final_snapshot       = false                # Snapshot OBLIGATOIRE
enable_performance_insights = true               # Insights OBLIGATOIRES
enable_query_insights      = true

# Labels OBLIGATOIRES
labels = {
  environment   = "prod"
  project       = "data-centralization"
  team          = "platform"                     # Remplacez par votre √©quipe
  cost-center   = "it-infrastructure"           # Centre de co√ªt IT
  backup        = "required"
  monitoring    = "critical"
  compliance    = "required"
  data-class    = "confidential"
}

# Configuration des secrets - Multi-r√©gion
enable_secret_manager      = true
secret_locations          = ["europe-west1", "europe-west4"]  # Multi-r√©gion OBLIGATOIRE

# Configuration backup et disaster recovery
backup_cross_region        = true                # Cross-r√©gion OBLIGATOIRE
backup_location_secondary  = "europe-west4"
enable_point_in_time_recovery = true

# Performance OPTIMIS√âE
enable_connection_pooling  = true
max_connections           = 200                 # Connexions optimis√©es
shared_preload_libraries  = "pg_stat_statements,auto_explain"  # Monitoring avanc√©

# Monitoring COMPLET
enable_slow_query_log     = true
slow_query_threshold      = "1s"               # Seuil strict
enable_connection_logging = true
enable_checkpoints_logging = true

# S√©curit√© MAXIMALE
require_ssl               = true               # SSL OBLIGATOIRE
ssl_mode                 = "ENCRYPTED_ONLY"    # Chiffrement strict
enable_pgaudit           = true               # Audit PostgreSQL
log_statement            = "all"              # Log TOUTES les requ√™tes
log_min_duration_statement = 1000             # Log requ√™tes > 1s

# üìù NOTES IMPORTANTES:
# - V√©rifiez TOUS les emails et webhooks
# - Testez les alertes avant la mise en production
# - Configurez les budgets selon votre organisation
# - Adaptez les IP autoris√©es √† votre infrastructure
# - Documentez toute modification 